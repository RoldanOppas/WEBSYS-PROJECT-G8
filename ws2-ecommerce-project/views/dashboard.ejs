<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - Sweet Haven Bakery</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i class="fas fa-birthday-cake"></i>
                </div>
                <div class="sidebar-title">Sweet Haven</div>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Main Menu</div>
                    <div class="nav-item">
                        <a href="/users/dashboard" class="nav-link active">
                            <i class="fas fa-chart-line"></i>
                            Dashboard
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-shopping-bag"></i>
                            My Orders
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-bread-slice"></i>
                            Browse Products
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-heart"></i>
                            Favorites
                        </a>
                    </div>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Account</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-user-edit"></i>
                            Profile Settings
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-credit-card"></i>
                            Payment Methods
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-map-marker-alt"></i>
                            Delivery Addresses
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-clock"></i>
                            Order History
                        </a>
                    </div>
                </div>
                
                <% if (user.role === 'admin') { %>
                <div class="nav-section">
                    <div class="nav-section-title">Bakery Management</div>
                    <div class="nav-item">
                        <a href="/users/admin" class="nav-link">
                            <i class="fas fa-users-cog"></i>
                            Customer Management
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-cookie-bite"></i>
                            Product Management
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-receipt"></i>
                            Orders & Invoices
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-chart-bar"></i>
                            Sales Analytics
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-warehouse"></i>
                            Inventory
                        </a>
                    </div>
                </div>
                <% } %>
                
                <div class="nav-section">
                    <div class="nav-section-title">Support</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-question-circle"></i>
                            Help Center
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-bell"></i>
                            Notifications
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="/users/logout" class="nav-link">
                            <i class="fas fa-sign-out-alt"></i>
                            Sign Out
                        </a>
                    </div>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="sidebar-toggle" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title">My Dashboard</h1>
                </div>
                
                <div class="header-right">
                    <div class="user-menu">
                        <div class="user-avatar">
                            <%= user.firstName.charAt(0).toUpperCase() + user.lastName.charAt(0).toUpperCase() %>
                        </div>
                        <div class="user-info">
                            <div class="user-name"><%= user.firstName %> <%= user.lastName %></div>
                            <div class="user-role"><%= user.role === 'admin' ? 'Bakery Admin' : 'Customer' %></div>
                        </div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </header>
            
            <!-- Content -->
            <main class="content">
                <!-- Welcome Section -->
                <div class="welcome-card">
                    <div class="welcome-content">
                        <h1 class="welcome-title">Welcome back, <%= user.firstName %>!</h1>
                        <p class="welcome-subtitle">Freshly baked goodness awaits! Check out your account overview and discover our latest treats.</p>
                        <div class="welcome-time">
                            <i class="fas fa-clock"></i>
                            <span id="currentTime"></span>
                        </div>
                    </div>
                </div>
                
                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value">0</div>
                            <div class="stat-label">Total Orders</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon success">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value">0</div>
                            <div class="stat-label">Delivered Orders</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value">0</div>
                            <div class="stat-label">Favorite Items</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon info">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value"><%= user.isEmailVerified ? 'âœ“' : '!' %></div>
                            <div class="stat-label">Account Status</div>
                        </div>
                    </div>
                </div>
                
                <!-- Information Cards -->
                <div class="info-grid">
                    <!-- Personal Information -->
                    <div class="info-card">
                        <div class="info-card-header">
                            <div class="info-card-icon" style="background: linear-gradient(135deg, #d97706, #ea580c);">
                                <i class="fas fa-user"></i>
                            </div>
                            <h3 class="info-card-title">Personal Information</h3>
                        </div>
                        <div class="info-items">
                            <div class="info-item">
                                <span class="info-label">Full Name</span>
                                <span class="info-value"><%= user.firstName %> <%= user.lastName %></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Email Address</span>
                                <span class="info-value"><%= user.email %></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Account Type</span>
                                <span class="status-badge <%= user.role === 'admin' ? 'admin' : 'user' %>">
                                    <%= user.role === 'admin' ? 'Bakery Admin' : 'Customer' %>
                                </span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Customer ID</span>
                                <span class="info-value">#<%= user.userId %></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Account Security -->
                    <div class="info-card">
                        <div class="info-card-header">
                            <div class="info-card-icon" style="background: linear-gradient(135deg, #059669, #047857);">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3 class="info-card-title">Account Security</h3>
                        </div>
                        <div class="info-items">
                            <div class="info-item">
                                <span class="info-label">Email Verified</span>
                                <span class="status-badge <%= user.isEmailVerified ? 'verified' : 'pending' %>">
                                    <%= user.isEmailVerified ? 'Verified' : 'Pending' %>
                                </span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Account Status</span>
                                <span class="status-badge active">Active</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Two-Factor Auth</span>
                                <span class="status-badge pending">Not Enabled</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Last Login</span>
                                <span class="info-value">Just now</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="quick-actions">
                    <a href="#" class="quick-action">
                        <div class="quick-action-icon" style="background: linear-gradient(135deg, #d97706, #ea580c);">
                            <i class="fas fa-bread-slice"></i>
                        </div>
                        <div class="quick-action-title">Browse Menu</div>
                        <div class="quick-action-desc">Explore our fresh bakery items</div>
                    </a>
                    
                    <a href="#" class="quick-action">
                        <div class="quick-action-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="quick-action-title">Place Order</div>
                        <div class="quick-action-desc">Start a new order today</div>
                    </a>
                    
                    <a href="#" class="quick-action">
                        <div class="quick-action-icon" style="background: linear-gradient(135deg, #059669, #047857);">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="quick-action-title">Order History</div>
                        <div class="quick-action-desc">View past orders & reorder</div>
                    </a>
                    
                    <a href="#" class="quick-action">
                        <div class="quick-action-icon" style="background: linear-gradient(135deg, #0891b2, #0e7490);">
                            <i class="fas fa-gift"></i>
                        </div>
                        <div class="quick-action-title">Special Offers</div>
                        <div class="quick-action-desc">Check out today's deals</div>
                    </a>
                </div>
                
                <!-- Recent Activity Feed -->
                <div class="activity-feed">
                    <div class="activity-header">
                        <div class="info-card-icon" style="background: linear-gradient(135deg, #78716c, #57534e);">
                            <i class="fas fa-history"></i>
                        </div>
                        <h3 class="info-card-title">Recent Activity</h3>
                    </div>
                    
                    <div class="activity-item">
                        <div class="activity-icon" style="background: linear-gradient(135deg, #059669, #047857);">
                            <i class="fas fa-sign-in-alt"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Account Login</div>
                            <div class="activity-time">Just now</div>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="activity-icon" style="background: linear-gradient(135deg, #d97706, #ea580c);">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Account Created</div>
                            <div class="activity-time">Welcome to Sweet Haven Bakery!</div>
                        </div>
                    </div>
                    
                    <% if (!user.isEmailVerified) { %>
                    <div class="activity-item">
                        <div class="activity-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div class="activity-content">
                            <div class="activity-title">Email Verification Pending</div>
                            <div class="activity-time">Please verify your email to unlock all features</div>
                        </div>
                    </div>
                    <% } %>
                </div>
                
                <!-- Action Buttons -->
                <div class="action-buttons">
                    <a href="#" class="btn btn-primary">
                        <i class="fas fa-bread-slice"></i>
                        Browse Products
                    </a>
                    <a href="#" class="btn btn-secondary">
                        <i class="fas fa-user-edit"></i>
                        Edit Profile
                    </a>
                    <% if (!user.isEmailVerified) { %>
                    <a href="#" class="btn btn-secondary">
                        <i class="fas fa-envelope-circle-check"></i>
                        Verify Email
                    </a>
                    <% } %>
                    <a href="#" class="btn btn-secondary">
                        <i class="fas fa-map-marker-alt"></i>
                        Manage Addresses
                    </a>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        // Current time display
        function updateCurrentTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            const timeElement = document.getElementById('currentTime');
            if (timeElement) {
                timeElement.textContent = now.toLocaleDateString('en-US', options);
            }
        }
        
        updateCurrentTime();
        setInterval(updateCurrentTime, 60000);
        
        // Sidebar toggle functionality
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        
        if (sidebarToggle && sidebar) {
            sidebarToggle.addEventListener('click', function() {
                sidebar.classList.toggle('open');
                localStorage.setItem('sidebarOpen', sidebar.classList.contains('open'));
            });
            
            // Restore sidebar state
            if (localStorage.getItem('sidebarOpen') === 'true') {
                sidebar.classList.add('open');
            }
            
            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', function(e) {
                if (window.innerWidth <= 768) {
                    if (!sidebar.contains(e.target) && !sidebarToggle.contains(e.target)) {
                        sidebar.classList.remove('open');
                    }
                }
            });
        }
        
        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });
    </script>
</body>
</html>